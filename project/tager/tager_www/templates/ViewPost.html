{% extends 'base.html' %}
{% load staticfiles%}

{% block headers %}
    {% include 'jquery_raty_min_js.html' %}
    <link href="{% static "css/application.css" %}" rel="stylesheet" media="screen">
{% endblock %}

{% block content%}
<title> Welcome to the post page </title>
<div class="container-fluid">
    <div class="row-fluid">
		    <div  class="span6">
		    	<div id="imagediv" >		
		    		 <img style="width: 300px;" src="static/img/post.png">
			</div>
			</div>
    		<div id = "contentdiv"class="span4" position="right">
	
				<h3> Title: {{post.title}}</h3>

				<h3> Description: {{post.description}}</h3>

				<h3> Price: {{post.price}}</h3>

				<h3> State: {{post.state}} </h3>


				{% if list_of_att_name %}

					{% for Attribute in list_of_att_name %}

					<h3>{{Attribute.name}}</h3>

					{% endfor %}
				{% endif %}

				{% if list_of_att_values %}

					{% for Value in list_of_att_values %}

					<h3>{{Value.value}}</h3>

					{% endfor %}

				{% endif %}  
				{% if add_buyer_button %}
					<button class="btn btn-mini btn-danger" id="addBuyer" value="{{post.id}}" type="button">Add Buyer</button>
				{% endif %}

    
    
    			{% if view_rating %}
    				<button class="btn btn-mini btn-primary" id="rateSeller" value="{{post.seller.id}}" type="button">Rate Seller</button>
    			{% endif %}
    			<div id="star"></div>
    
				<button type="button" class="btn btn-info"> fb </button>
				<a class="btn btn-info" href="#myModal2" id ="get_interested_in{{post.id}}" role="button" data-toggle="modal"> Show Interested In</a>
				<button type="button" class="btn btn-info"> Interested in </button>
				<a href="#myModal" role="button" class="btn btn-danger " data-toggle="modal"><i class="icon-warning-sign"></i> </a>
	 		</div>
 	</div>
<div id = "listOfBuyers{{post.id}}" style="display:none">
	{% for buyer in list_of_interested_buyers %}
		<h3>{{ buyer }}</h3>
	{% endfor %}
</div>



 
<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Report A Post</h3>
    <p>
    	Please provide us with your reason for reporting this post:
    </p>
  </div>
  <div class="modal-body">
  		{% for reasons in report_reasons %}
	<label class="R{{reasons.id}}">
  		<input type="radio" name="optionsRadios{{post.id}}" id="optionsRadios{{post.id}}" value="{{reasons.reported_reason}}" checked>
  			{{reasons.reported_reason}}
	</label>
	{% endfor %}
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    <button class="btn btn-primary" id = "postID" onCLick ="reportPost({{post.id}});">Submit Report</button>
  </div>
</div>
</div>



<div id="myModal2" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Buyers Interested in Your Post:</h3>
    
  </div>
  <div class="modal-body">
  		{% for buyers in list_of_interested_buyers %}
  			{{ buyers }}
		{% endfor %}	
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Back</button>
  </div>
</div>
</div>


</div>


</div>
{% block script%}

    <script type="text/javascript">

    $(document).ready(function(){
        $("#star").css("visibility", "hidden");
    });
    $("#rateSeller").click(function(){
        // window.location.replace("profile?user_id="+$(this).val());
        $("#star").css("visibility", "visible");
    });
    $(document).ready(function(){
        $('#star').raty({ 
            score: $('#rating').val(),
            click: function(score, evt) {
            //alert('ID: ' + $(this).attr('id') + "\nscore: " + score + "\nevent: " + evt);
            $.ajax({
                type: 'GET',
                url: '/rateUser/',
                data: { post_id: '{{post.id}}', post_owner: '{{post.seller.id}}', rating: score },
                success: function(){  
                    $('#div.success').css("visibility", "hidden");  
                }


                         });

        },

    });
});
    </script>
    {% endblock %}


    {% endblock %}
